<div class="orders-page">
  <div class="page-header">
    <h1>Orders Management</h1>
    <p>Manage and track customer orders</p>
  </div>

  <!-- Statistics -->
  <div class="stats-grid">
    <div class="stat-card">
      <h3>Total Orders</h3>
      <p class="stat-number">{{ orders.length }}</p>
    </div>
    <div class="stat-card">
      <h3>Revenue</h3>
      <p class="stat-number">${{ getTotalRevenue() | number:'1.2-2' }}</p>
    </div>
    <div class="stat-card">
      <h3>Pending</h3>
      <p class="stat-number">{{ pendingCount }}</p>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <input
      type="text"
      placeholder="Search by address, phone, product, or customer..."
      [(ngModel)]="searchQuery"
    />

    <select [(ngModel)]="statusFilter">
      <option value="all">All Status</option>
      <option value="pending">Pending</option>
      <option value="shipped">Shipped</option>
      <option value="delivered">Delivered</option>
      <option value="canceled">Canceled</option>
      <option value="rejected">Rejected</option>
    </select>
  </div>

  <!-- Loading State -->
  @if(isLoading) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Loading orders...</p>
    </div>
  }

  <!-- Orders Table -->
  @if(!isLoading) {
    <div class="orders-table">
      @if(getFilteredOrders().length > 0) {
        <table>
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Product</th>
              <th>Quantity</th>
              <th>Total</th>
              <th>Address</th>
              <th>Phone</th>
              <th>Status</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for(order of getFilteredOrders(); track order._id) {
              <tr>
                <td>{{ order._id | slice:0:8 }}...</td>
                <td>{{ getUserName(order) }}</td>
                <td>{{ getProductName(order) }}</td>
                <td>{{ order.quantity }}</td>
                <td>${{ order.totalPrice | number:'1.2-2' }}</td>
                <td class="address-cell">{{ order.address }}</td>
                <td>{{ order.phonenumber }}</td>
                <td>
                  <span [class]="'status-badge ' + getStatusColor(order.status)">
                    {{ order.status }}
                  </span>
                </td>
                <td>{{ order.createdAt | date:'short' }}</td>
                <td>
                  <div class="actions">
                    <!-- ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¯Ø§Ø®Ù„ @for -->
<select
  (change)="onStatusChange(order._id, $event)"
  [value]="order.status"
>
  <option value="pending">Pending</option>
  <option value="shipped">Shipped</option>
  <option value="delivered">Delivered</option>
  <option value="canceled">Canceled</option>
  <option value="rejected">Rejected</option>
</select>
                  </div>
                </td>
              </tr>
            }
          </tbody>
        </table>
      } @else {
        <div class="no-orders">
          <div class="no-orders-icon">
            ðŸ“¦
          </div>
          <h3>No orders found</h3>
          <p>Try changing your filters or check back later.</p>
        </div>
      }
    </div>
  }
</div>
